
| **Критерий**          | **`unique_ptr`**                        | **`shared_ptr`**                        | **`weak_ptr`**                            |
| --------------------- | --------------------------------------- | --------------------------------------- | ----------------------------------------- |
| **Владение**          | Исключительное (только один владелец)   | Совместное (много владельцев)           | Нет владения (только наблюдение)          |
| **Счётчики ссылок**   | Нет                                     | `strong_refs` (для `shared_ptr`)        | `weak_refs` (только для Control Block)    |
| **Копирование**       | Запрещено (только перемещение)          | Разрешено (увеличивает `strong_refs`)   | Разрешено (увеличивает `weak_refs`)       |
| **Перемещение**       | Разрешено (`std::move`)                 | Разрешено (`std::move`)                 | Разрешено (`std::move`)                   |
| **Доступ к объекту**  | Прямой (`*`, `->`)                      | Прямой (`*`, `->`)                      | Только через `.lock()` → `shared_ptr`     |
| **Удаление объекта**  | При разрушении `unique_ptr`             | Когда `strong_refs == 0`                | Не управляет временем жизни               |
| **Использование**     | 1 владелец (например, члены класса)     | Много владельцев (кэши, общие ресурсы)  | Обход циклических зависимостей, кэши      |
| **Накладные расходы** | Минимальные (как сырой указатель)       | Высокие (счётчики, Control Block)       | Средние (требует `shared_ptr` для работы) |
| **Безопасность**      | Нет циклических зависимостей            | Риск циклических зависимостей           | Нет риска циклических зависимостей        |
| **Пример**            | `auto ptr = std::make_unique<int>(10);` | `auto ptr = std::make_shared<int>(10);` | `std::weak_ptr<int> weak = shared;`       |

**Ключевые выводы**  
1. **`unique_ptr`** — для эксклюзивного владения (быстрый, без накладных расходов).  
2. **`shared_ptr`** — для общего доступа (гибкий, но дорогой из-за счётчиков).  
3. **`weak_ptr`** — для наблюдения без владения (ломает циклы, безопасный доступ через `.lock()`).  

**Когда что использовать**:  
- **`unique_ptr`** — владение объектом в одном месте (например, фабрики).  
- **`shared_ptr`** — разделяемые ресурсы (например, кэш в многопоточке).  
- **`weak_ptr`** — избегание циклов (например, `parent-child` в деревьях).  